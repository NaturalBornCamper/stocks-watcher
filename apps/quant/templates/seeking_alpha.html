{% extends 'base.html' %}

{% block head_css %}
    <style>
        table, th, td {
            border: 1px solid black;
        }

        th {
            cursor: pointer;
        }
    </style>
{% endblock %}

{% block sa_ratings_menu %}
<!-- SA ratings menu will go here, to navigate between reports -->
{% endblock sa_ratings_menu %}

{% block content %}
    <!-- Main Content -->
{% endblock content %}

{% block footer_js %}
    <script>
        const getCellValue = (tr, idx) => tr.children[idx].dataset.sort;

        const comparer = (idx, asc) => {
            const getCellValue = (tr, idx) => tr.children[idx].dataset.sort;
            const compareValues = (v1, v2) => {
                if (v1 === '' || v2 === '' || isNaN(v1) || isNaN(v2)) {
                    return v1.toString().localeCompare(v2);
                }
                return v1 - v2;
            };
            return (a, b) => {
                const valueA = getCellValue(asc ? a : b, idx);
                const valueB = getCellValue(asc ? b : a, idx);
                return compareValues(valueA, valueB);
            };
        };

        document.querySelectorAll('th').forEach(th => th.addEventListener('click', (() => {
            const table = th.closest('table').querySelector('tbody');
            Array.from(table.querySelectorAll('tr:nth-child(n+2)'))
                .sort(comparer(Array.from(th.parentNode.children).indexOf(th), this.asc = !this.asc))
                .forEach(tr => table.appendChild(tr));
        })));
    </script>
{% endblock %}